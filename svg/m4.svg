<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 550" width="900" height="550" font-family="'Segoe UI','Apple SD Gothic Neo','Malgun Gothic',sans-serif"> <style>  } .bg { fill: #FAFBFC; } /* Center box */ .center-box { opacity: 1;  } .center-rect { fill: #172B4D; rx: 12; } .center-title { fill: #FFFFFF; font-size: 18px; font-weight: 800; text-anchor: middle; dominant-baseline: central; } .center-sub { fill: #B3BAC5; font-size: 13px; text-anchor: middle; dominant-baseline: central; } /* Role nodes */ .role-node { opacity: 1; } .role-rect { rx: 10; } .role-title { fill: #FFFFFF; font-size: 13px; font-weight: 700; text-anchor: middle; dominant-baseline: central; } .role-sub { fill: rgba(255,255,255,0.85); font-size: 9.5px; text-anchor: middle; dominant-baseline: central; } .icon-shape { fill: none; stroke: #fff; stroke-width: 1.5; stroke-linecap: round; stroke-linejoin: round; } .role-node .role-node .role-node .role-node /* Connection lines */ .conn-line { stroke-width: 2.5; fill: none; stroke-dasharray: 300; stroke-dashoffset: 0; opacity: 1; } .conn-line.c0 { stroke: #36B37E;  } .conn-line.c1 { stroke: #FFAB00;  } .conn-line.c2 { stroke: #0052CC;  } .conn-line.c3 { stroke: #6554C0;  } /* Index count badges */ .idx-count { opacity: 1; } .idx-badge { rx: 10; } .idx-text { font-size: 10px; font-weight: 700; fill: #172B4D; text-anchor: middle; dominant-baseline: central; } .idx-count .idx-count .idx-count .idx-count /* Center accumulation */ .accum { opacity: 1; }   .accum-title { fill: #FFAB00; font-size: 16px; font-weight: 800; text-anchor: middle; dominant-baseline: central; } .accum-detail { fill: #B3BAC5; font-size: 11px; text-anchor: middle; dominant-baseline: central; } .wal-text { fill: #FF5630; font-size: 13px; font-weight: 800; text-anchor: middle; dominant-baseline: central; opacity: 1;  } /* Warning pulse */ .warn-pulse { opacity: 1;  } /* Warning banner */ .warn-banner { opacity: 1;   } .warn-banner-bg { fill: #FF5630; rx: 8; } .warn-banner-text { fill: #FFFFFF; font-size: 12px; font-weight: 700; text-anchor: middle; dominant-baseline: central; }  to { opacity: 1; } }  60% { opacity: 1; transform: scale(1.2); } 100% { opacity: 1; transform: scale(1); } }  to { stroke-dashoffset: 0; opacity: 1; } }  to { opacity: 1;  } }  50% { opacity: 0.35; transform: scale(1.08); } } </style> <rect class="bg" width="900" height="550" rx="6" fill="none"/> <text x="450" y="30" text-anchor="middle" font-size="15" font-weight="800" fill="#172B4D">근본 원인 분석: 1 테이블 4 역할</text> <text x="450" y="48" text-anchor="middle" font-size="10" fill="#6B778C">t_coupon_issue 테이블이 수행하는 4가지 역할과 인덱스 누적 구조</text> <g class="center-box"> <rect class="warn-pulse" x="330" y="195" width="240" height="110" rx="16" fill="#FFAB00"/> <rect class="center-rect" x="340" y="200" width="220" height="100" rx="12"/> <text class="center-title" x="450" y="235">t_coupon_issue</text> <text class="center-sub" x="450" y="260">~1.7억 row</text> <g class="accum a1"> <text class="accum-title" x="450" y="282">인덱스 합계: 9개</text> </g> </g> <g class="accum a2"> <text class="accum-detail" x="450" y="320">INSERT 1건 → 인덱스 9회 갱신</text> </g> <text class="wal-text" x="450" y="342">WAL 증폭 10.1x</text> <g class="role-node n0"> <rect class="role-rect" x="365" y="65" width="170" height="80" fill="#36B37E"/> <g transform="translate(420, 80)"> <rect class="icon-shape" x="0" y="0" width="14" height="18" rx="1"/> <line class="icon-shape" x1="3" y1="5" x2="11" y2="5"/> <line class="icon-shape" x1="3" y1="9" x2="11" y2="9"/> <line class="icon-shape" x1="3" y1="13" x2="8" y2="13"/> </g> <text class="role-title" x="450" y="108">발급 원장</text> <text class="role-sub" x="450" y="125">INSERT → PK only</text> </g> <g class="role-node n1"> <rect class="role-rect" x="650" y="205" width="200" height="90" fill="#FFAB00"/> <g transform="translate(720, 215)"> <rect class="icon-shape" x="0" y="0" width="14" height="18" rx="2"/> <line class="icon-shape" x1="3" y1="5" x2="11" y2="5"/> <rect class="icon-shape" x="3" y="8" width="3" height="3" rx="0.5"/> <rect class="icon-shape" x="8" y="8" width="3" height="3" rx="0.5"/> <rect class="icon-shape" x="3" y="13" width="3" height="2" rx="0.5"/> <rect class="icon-shape" x="8" y="13" width="3" height="2" rx="0.5"/> </g> <text class="role-title" x="750" y="248">발급량 집계</text> <text class="role-sub" x="750" y="265">COUNT(*) WHERE coupon_no</text> <text class="role-sub" x="750" y="280" opacity="0.7" font-size="8">coupon_no 기반 집계 쿼리</text> </g> <g class="role-node n2"> <rect class="role-rect" x="350" y="385" width="200" height="80" fill="#0052CC"/> <g transform="translate(420, 395)"> <circle class="icon-shape" cx="7" cy="7" r="5"/> <line class="icon-shape" x1="11" y1="11" x2="15" y2="15"/> </g> <text class="role-title" x="450" y="423">쿠폰함 조회</text> <text class="role-sub" x="450" y="442">SELECT WHERE user_no</text> <text class="role-sub" x="450" y="455" opacity="0.7" font-size="8">사용자별 보유 쿠폰 목록</text> </g> <g class="role-node n3"> <rect class="role-rect" x="50" y="205" width="200" height="90" fill="#6554C0"/> <g transform="translate(120, 215)"> <path class="icon-shape" d="M7,1 L13,4 L13,10 C13,14 7,17 7,17 C7,17 1,14 1,10 L1,4 Z"/> <polyline class="icon-shape" points="4,9 6,11 10,7"/> </g> <text class="role-title" x="150" y="248">중복 발급 검증</text> <text class="role-sub" x="150" y="265">EXISTS (user_no, coupon_no)</text> <text class="role-sub" x="150" y="280" opacity="0.7" font-size="8">유니크 제약 기반 검증</text> </g> <line class="conn-line c0" x1="450" y1="200" x2="450" y2="145"/> <line class="conn-line c1" x1="560" y1="250" x2="650" y2="250"/> <line class="conn-line c2" x1="450" y1="300" x2="450" y2="385"/> <line class="conn-line c3" x1="340" y1="250" x2="250" y2="250"/> <g class="idx-count i0"> <rect class="idx-badge" x="462" y="162" width="65" height="22" fill="#E6FCFF" stroke="#36B37E" stroke-width="1.5" rx="11"/> <text class="idx-text" x="494" y="173" fill="#006644">+1 인덱스</text> </g> <g class="idx-count i1"> <rect class="idx-badge" x="595" y="222" width="65" height="22" fill="#FFF7E6" stroke="#FFAB00" stroke-width="1.5" rx="11"/> <text class="idx-text" x="627" y="233" fill="#FF8B00">+2 인덱스</text> </g> <g class="idx-count i2"> <rect class="idx-badge" x="462" y="355" width="65" height="22" fill="#E6FCFF" stroke="#0052CC" stroke-width="1.5" rx="11"/> <text class="idx-text" x="494" y="366" fill="#0747A6">+3 인덱스</text> </g> <g class="idx-count i3"> <rect class="idx-badge" x="265" y="222" width="82" height="22" fill="#EAE6FF" stroke="#6554C0" stroke-width="1.5" rx="11"/> <text class="idx-text" x="306" y="233" fill="#403294" font-size="9">+3 (unique)</text> </g> <g class="warn-banner"> <rect class="warn-banner-bg" x="140" y="495" width="620" height="40"/> <text class="warn-banner-text" x="450" y="515">Contention-bound 병목 → 스케일업이 아닌 구조 개선 필요</text> <g transform="translate(165, 503)"> <polygon points="10,2 18,18 2,18" fill="none" stroke="#fff" stroke-width="1.5" stroke-linejoin="round"/> <line x1="10" y1="8" x2="10" y2="13" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/> <circle cx="10" cy="16" r="0.8" fill="#fff"/> </g> </g> <g opacity="0.4"> <text x="20" y="540" font-size="8" fill="#6B778C">Section 1.2 — 근본 원인 분석</text> <text x="880" y="540" font-size="8" fill="#6B778C" text-anchor="end">M4</text> </g> </svg>